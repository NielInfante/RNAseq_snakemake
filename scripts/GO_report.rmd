## Gene Ontology

Gene ontology analysis was done on genes found to be significantly differentially expressed. The GO analysis was done separately for significantly up regulated genes, significantly down regulated genes, and all significant genes. The background in all cases is genes with enough expression to make it past the initial filters. The analysis was done for Molecular Function, Biological Process, and Cellular Component. Tables and figures were created for all of these analyses, and are available in the GO sub folder. Below are some selected outputs.

## GO Analysis Molecular Function
Significantly up regulated genes

```{r go_mf_table, message=F, warning=F}
res <- read_tsv(paste0(snakemake@scriptdir, "/../results/", exp, "/GO/all_up_genes_MF_results.txt"))

if(dim(res)[1] == 0){
	print("No significant ontological terms were found for molecular function")
} else {
	res <- res %>% select(ID, Description, GeneRatio, BgRatio, p.adjust)
	datatable(res, filter='bottom', options = list(pageLength=10, lengthMenu = c(5, 10, 25), scrollX=T)) %>% 
		formatRound('p.adjust', 3)
	#	formatRound('baseMean', 0)
	
}

```

## GO Analysis Molecular Function
Significantly up regulated genes

```{r go_mf_plot, out.width="90%", message=F, warning=F}

res <- read_tsv(paste0(snakemake@scriptdir, "/../results/", exp, "/GO/all_up_genes_MF_results.txt"))

if(dim(res)[1] == 0){
	print("No plot was created for molecular function")
} else {
	include_graphics(paste0(snakemake@scriptdir, "/../results/", exp, "/GO/all_up_genes_MF_bar.png"))
}
```


## GO Analysis Biological Processes
Significantly down regulated genes

```{r go_bp_table, message=F, warning=F}
res <- read_tsv(paste0(snakemake@scriptdir, "/../results/", exp, "/GO/all_down_genes_BP_results.txt"))

if(dim(res)[1] == 0){
	print("No significant ontological terms were found for Biological Processes")
} else {
	res <- res %>% select(ID, Description, GeneRatio, BgRatio, p.adjust)
	datatable(res, filter='bottom', options = list(pageLength=10, lengthMenu = c(5, 10, 25), scrollX=T)) %>% 
		formatRound('p.adjust', 3)
	#	formatRound('baseMean', 0)
	
}

```

## GO Analysis Biological Processes
Significantly down regulated genes

```{r go_bp_plot, out.width="90%", message=F, warning=F}
res <- read_tsv(paste0(snakemake@scriptdir, "/../results/", exp, "/GO/all_down_genes_BP_results.txt"))

if(dim(res)[1] == 0){
	print("No plot was created for Biological processes")
} else {
	include_graphics(paste0(snakemake@scriptdir, "/../results/", exp, "/GO/all_down_genes_BP_dot.png"))
}


```


## GO Analysis Cellular Components
Significant genes

```{r go_cc_table, message=F, warning=F}
res <- read_tsv(paste0(snakemake@scriptdir, "/../results/", exp, "/GO/all_genes_CC_results.txt"))

if(dim(res)[1] == 0){
	print("No significant ontological terms were found for Cellular Components")
} else {
	res <- res %>% select(ID, Description, GeneRatio, BgRatio, p.adjust)
	datatable(res, filter='bottom', options = list(pageLength=10, lengthMenu = c(5, 10, 25), scrollX=T)) %>% 
		formatRound('p.adjust', 3)
	#	formatRound('baseMean', 0)
	
}

```

## GO Analysis Cellular Components
Significant genes

```{r go_cc_plot, out.width="95%", message=F, warning=F}
res <- read_tsv(paste0(snakemake@scriptdir, "/../results/", exp, "/GO/all_genes_BP_results.txt"))

if(dim(res)[1] == 0){
	print("No plot was created for cellular components")
} else {
	include_graphics(paste0(snakemake@scriptdir, "/../results/", exp, "/GO/all_genes_CC_GO_graph.png"))
}


```
